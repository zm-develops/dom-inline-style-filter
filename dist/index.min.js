/*! dom-inline-style-filter 03-11-2025 */
(()=>{{let c=globalThis.document.body||globalThis.document.documentElement,n=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,o=null,d={},u=new Set(["address","article","aside","blockquote","details","dialog","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","ol","p","pre","section","svg","table","ul","math","ruby","svg","body","head","html"]),r=["animation-duration","transition-duration"],l=["transform-origin","perspective-origin"],h=new Set(["align-items","appearance","background-color","border","bottom","box-sizing","color","cursor","display","font-size","height","inset","interactivity","left","lettter-spacing","margin","max-height","max-width","min-height","min-width","opacity","overlay","outline","outline-offset","padding","perspective-origin","pointer-events","position","right","text-align","text-indent","text-spacing","text-underline","transform-origin","top","unicode-bidi","user-modify","user-select","vertical-align","visibility","white-space","width","word-spacing"]),i=function(e,t){return(t=t||{}).debug=("boolean"==typeof t.debug?t:i.impl.options).debug,t.strict=("boolean"==typeof t.strict?t:i.impl.options).strict,e=new a(e,t),new Promise(b(e)).then(v).then(x).then(w).then(I).catch(I.bind(null,e))};function a(e,t){this.root=e,this.sibling=e.nextSibling,this.parent=e.parentElement,this.sandbox=null,this.self=null,this.tree=null,this.stack=[],this.pyramid=null,this.cutoff=null,this.depths=[],this.depth=null,this.declarations=null,this.bytes=null,this.delta=null,this.processed=[],this.options=t,this.options.debug=("boolean"==typeof t.debug?t:i.impl.options).debug,this.options.strict=("boolean"==typeof t.strict?t:i.impl.options).strict}function m(e,t){this.context=e,this.element=t,this.inline=t.style,this.computed=e.self.getComputedStyle(t)}"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=i:"function"==typeof define&&define.amd?define(()=>i):globalThis.dominlinestylefilter=i,i.sync=function(e,t){e=new a(e,t=t||{});try{let t=(e=>{let t;return e(e=>{t=e},e=>{throw new Error(e)}),t})(b(e));return[v,x,w,I].forEach(function(e){t=e(t)}),t}catch(t){I(e,t)}},i.impl={},i.impl.options={},i.impl.options.debug=!1,i.impl.options.strict=!1;let p=new Set;function g(){return Math.floor(9e3*Math.random())+1e3}function y(e){var t;return e?((t=globalThis.document.createElement("div")).innerText=e,t.innerHTML):""}function b(n){return(e,t)=>{n.sandbox=(()=>{let e=globalThis.document.createElementNS("http://www.w3.org/1999/xhtml","iframe"),t=g();for(;p.has(t);)t=g();e.id="dominlinestylefilter-sandbox-"+t,p.add(t),e.style.visibility="hidden",e.style.position="fixed",e.style.width="100vw",e.style.height="100vh";var n=globalThis.document.characterSet||"UTF-8",o=(o=globalThis.document.doctype)?(`<!DOCTYPE ${y(o.name)} ${y(o.publicId)} `+y(o.systemId)).trim()+">":"",i=(c.appendChild(e),e),r=e.id;try{return i.contentWindow.document.write(o+`<html><head><meta charset='${n}'><title>${r}</title></head><body></body></html>`),i}catch(i){}var l=globalThis.document.createElement("meta");l.setAttribute("charset",n);try{var s=globalThis.document.implementation.createHTMLDocument(r),a=(s.head.appendChild(l),o+s.documentElement.outerHTML);return i.setAttribute("srcdoc",a),i}catch(i){}return i.contentDocument.head.appendChild(l),i.contentDocument.title=r,i})(),n.self=n.sandbox.contentWindow,n.self.document.body.appendChild(n.root),n.sandbox.parentElement||t("failed to append sandbox iframe to DOM"),e(n)}}function v(e){var t,n=e.self.document.createTreeWalker(e.root,globalThis.NodeFilter.SHOW_ELEMENT);e.cutoff=e.depth=1,e.tree=[e.root],e.depths=[e.depth],e.stack=[],e.pyramid=[],e.declarations=e.root.style.length,e.bytes=e.root.style.cssText.length,e.processed=[!1];let o=0;for(;t=n.nextNode();){o+=1,e.tree.push(t);var i=T.call(e,t,o);e.depths.push(i),e.declarations+=t.style.length,e.bytes+=t.style.cssText.length,e.processed.push(!1)}return e}function x(n){for(let t=n.cutoff;0<t;t--)for(let e=0;e<n.tree.length;e++)n.depths[e]===t&&n.pyramid.push(n.tree[e]);return n.tree=null,n}function T(t,e){var n=this,o=n.tree[e-1]||null;if(t.parentElement===o)n.depth+=1,n.stack.push(e-1),n.depth>n.cutoff&&(n.cutoff=n.depth);else if(t.previousElementSibling!==o)for(let e=n.stack.length;0<=e;e--){var i=n.stack[e];if(n.tree[i]===t.parentElement){n.depth=n.depths[i]+1,n.stack=n.stack.slice(0,e+1);break}}return n.depth}function w(e){let t,n=0;for(e.pyramid.forEach(P),e.root.querySelectorAll("style").forEach(S),e.options.debug&&(t=E(e)),6<=Math.round(Math.log2(e.declarations/e.pyramid.length))&&(e.delta=0,e.pyramid.forEach(function(e,t){var n,o,i,r,l,s,a;t.attributes.style&&(o=(n=new m(e,t)).inline.cssText.length,e.bytes-=o,e.delta+=o,o=(e=>{var t,n={};for(t of h){var o=e.inline.getPropertyValue(t);o&&(n[t]=o)}return n})(n),i=M(n),r=t!==e.root?e.self.getComputedStyle(t.parentElement):null,l=e,a=s=(t=>{var n=[t.tagName.toLowerCase()];if(!u.has(t.tagName.toLowerCase())){let e=t;for(;e=e.parentNode;)if(e.nodeType===globalThis.Node.ELEMENT_NODE){var o=e.tagName.toLowerCase();if(n.push(o),u.has(o))break}}return n})(t),a=(!1===l.options.strict?a.filter(f).reverse().join(" "):a.reverse().join(">")).toLowerCase(),a=d[a]||(s=((e,t)=>{let n=e.body;for(;0<t.length;){var o=t.pop(),o=e.createElement(o);n.appendChild(o),n=o}return n.textContent="â€‹",n})(l.self.document,s),l=(()=>{let t={},n=l.self.getComputedStyle(s);return Array.from(n).forEach(function(e){t[e]="width"===e||"height"===e?"auto":n.getPropertyValue(e)}),t})(),(()=>{let e=s;for(var t=s.parentElement;e&&"BODY"!==e.tagName;)null!==(t=e.parentElement)&&t.removeChild(e),e=t})(),d[a]=l),N(n.inline.cssText).map(V).sort(L).forEach(function(e,t,n,o){var i,r;"width"!==o&&"height"!==o&&"transform-origin"!==o&&"perspective-origin"!==o&&"animation-duration"!==o&&"transition-duration"!==o&&(i=e.inline.getPropertyValue(o),n=n[o],r=t?t.getPropertyValue(o):void 0,n)&&i===n&&(!r||t&&i===r)&&(e.inline.removeProperty(o),--e.context.declarations)}.bind(null,n,r,a)),k(n,i),((e,t)=>{for(var n of h)e.inline.setProperty(n,t[n])})(n,o),r=n.inline.cssText.length,e.bytes+=r,e.delta-=r,""===t.getAttribute("style"))&&t.removeAttribute("style")}.bind(null,e)),e.options.debug&&E(e,t),e.delta=null),e.options.debug&&(t=C(e,null,n));0!==e.delta;)e.delta=0,e.pyramid.forEach(A.bind(null,e)),e.options.debug&&C(e,null,n+=1);return e.options.debug&&C(e,t),e}let s=e=>Math.round(1e3*e)/1e3;function E(e,t){if(!t)return console.info("filterAuthorInlineStyles"),console.info("context.pyramid.length",e.pyramid.length),console.info("context.declarations",e.declarations),console.info("context.bytes",e.bytes),performance.now();console.info("filterAuthorInlineStyles"),console.info("context.declarations",e.declarations),console.info("context.bytes",e.bytes),console.info("context.delta",e.delta),console.info("runtime(ms)",s(performance.now()-t))}function C(e,t,n){if(0===n)return console.info("filterActiveInlineStyles"),console.info("context.declarations",e.declarations),console.info("context.bytes",e.bytes),performance.now();n?console.info("filterActiveInlineStyles","pass #"+n):(console.info("filterActiveInlineStyles"),console.info("runtime(ms)",s(performance.now()-t))),console.info("context.declarations",e.declarations),console.info("context.bytes",e.bytes),console.info("context.delta",e.delta)}function P(e){var t=e.getAttribute("style");n.test(t)&&e.setAttribute("style",t.replace(n,""))}function S(e){if(e.media&&!globalThis.matchMedia(e.media).matches)e.parentElement.removeChild(e);else if(e.textContent.includes("@media"))for(var t,n=/@media([^{]+)\{((?:(?!\}\s*\})[\s\S])*\})\s*\}/;t=n.exec(e.textContent);){var o=t[1].trim(),i=t[2].trim();globalThis.matchMedia(o).matches?e.textContent=e.textContent.replace(t[0],i):e.textContent=e.textContent.replace(t[0],"")}}function A(e,t,n){var o,i,r;t.attributes.style&&!0!==e.processed[n]&&(i=(o=new m(e,t)).inline.cssText.length,e.bytes-=i,e.delta+=i,r=M(o),(e=>{for(var t of l){var n=e.inline.getPropertyValue(t),o=e.computed.getPropertyValue(t);if(!n)return;e.inline.removeProperty(t),o=o.replace(/[0-9.]+/g,function(e){return Math.round(1e4*parseFloat(e))/1e4}),e.computed.getPropertyValue(t)!==o&&e.inline.setProperty(t,n)}})(o),"none"===o.inline.display?(e.declarations-=o.inline.length,o.inline.cssText="display: none;",e.declarations+=1):N(o.inline.cssText).map(V).sort(L).forEach(function(i,r){if("width"!==r&&"height"!==r&&"transform-origin"!==r&&"perspective-origin"!==r&&"animation-duration"!==r&&"transition-duration"!==r){let e,t=i.inline.getPropertyValue(r),n=N(i.inline.cssText),o=n.findIndex(e=>r===V(e));-1!==o&&(i.inline.cssText=n.filter((e,t)=>t!==o).join("; ")+";",e=""===t,t=t===i.computed.getPropertyValue(r),e||t?--i.context.declarations:i.inline.cssText=n.join("; ")+";")}}.bind(null,o)),k(o,r),r=o.inline.cssText.length,e.bytes+=r,e.delta-=r,r===i&&(e.processed[n]=!0),""===t.getAttribute("style"))&&t.removeAttribute("style")}function M(e){let t=!1,n=null;for(var o of r){var i=e.inline.getPropertyValue(o);i&&(["auto","0s"].includes(i)?e.inline.removeProperty(o):(t=!0,(n=n||{})[o]=i,e.inline.setProperty(o,"0s")))}return t?n:void 0}function k(e,t){if(t)for(var n of r)t[n]&&e.inline.setProperty(n,t[n])}let f=(e,t,n)=>0===t||t===n.length-1;function N(t){let n=[],o=!1,i=0;for(let e=0;e<t.length;e++){'"'!==(r=t.charAt(e))&&"'"!==r||(o=!o);var r=";"===r,l=e===t.length-1;o||!r&&!l||(l=t.substring(i,l&&!r?e+1:e).trim(),n.push(l),i=e+1)}return n}function V(e){return e.slice(0,e.indexOf(":"))}function L(e,t){var n=e=>/^--\b/.test(e),o=e=>/^-\b/.test(e);return n(e)&&!n(t)?1:!n(e)&&n(t)?-1:o(e)&&!o(t)?1:!o(e)&&o(t)?-1:t.split("-").length-e.split("-").length}function I(e,t){if(e.parent&&e.parent.insertBefore(e.root,e.sibling),e.sandbox&&e.sandbox.parentElement&&c.removeChild(e.sandbox),e.sandbox&&(e.self=null,e.sandbox=null),o&&clearTimeout(o),o=setTimeout(()=>{o=null,d={}},2e4),t&&t.stack)throw t;return e.root}}})();
//# sourceMappingURL=index.min.js.map